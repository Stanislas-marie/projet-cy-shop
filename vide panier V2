#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void validerPanier(const char* clientName) {
    char panierFile[100] = "panier.txt";
    char historiqueFile[100];
    FILE* panier = fopen(panierFile, "r");
    FILE* historique = NULL;
    FILE* tempPanier = NULL;

    if (panier == NULL) {
        printf("Erreur : impossible d'ouvrir le fichier panier.txt.\n");
        return;
    }

    snprintf(historiqueFile, sizeof(historiqueFile), "%s.txt", clientName);
    historique = fopen(historiqueFile, "a");
    tempPanier = fopen("temp_panier.txt", "w");

    if (historique == NULL || tempPanier == NULL) {
        printf("Erreur : impossible d'ouvrir les fichiers d'historique ou de panier temporaire.\n");
        fclose(panier);
        fclose(historique);
        fclose(tempPanier);
        return;
    }

    char ligne[1000];
    while (fgets(ligne, sizeof(ligne), panier) != NULL) {
        fputs(ligne, historique);
    }

    fclose(panier);
    fclose(historique);
    remove(panierFile);
    rename("temp_panier.txt", panierFile);

    printf("Votre panier a été validé avec succès.\n");
}
